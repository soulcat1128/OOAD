(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-709bab5d"],{"0ccb":function(e,t,a){var l=a("50c4"),r=a("1148"),i=a("1d80"),s=Math.ceil,n=function(e){return function(t,a,n){var o,p,c=String(i(t)),u=c.length,d=void 0===n?" ":String(n),f=l(a);return f<=u||""==d?c:(o=f-u,p=r.call(d,s(o/d.length)),p.length>o&&(p=p.slice(0,o)),e?c+p:p+c)}};e.exports={start:n(!1),end:n(!0)}},1148:function(e,t,a){"use strict";var l=a("a691"),r=a("1d80");e.exports="".repeat||function(e){var t=String(r(this)),a="",i=l(e);if(i<0||i==1/0)throw RangeError("Wrong number of repetitions");for(;i>0;(i>>>=1)&&(t+=t))1&i&&(a+=t);return a}},"27b5":function(e,t,a){"use strict";a("d231")},"4d90":function(e,t,a){"use strict";var l=a("23e7"),r=a("0ccb").start,i=a("9a0c");l({target:"String",proto:!0,forced:i},{padStart:function(e){return r(this,e,arguments.length>1?arguments[1]:void 0)}})},"58d9":function(e,t,a){"use strict";a.d(t,"b",(function(){return r})),a.d(t,"e",(function(){return i})),a.d(t,"c",(function(){return s})),a.d(t,"d",(function(){return n})),a.d(t,"a",(function(){return o})),a.d(t,"f",(function(){return p}));var l=a("b775");function r(e){return Object(l["a"])({url:"/appeal/createAppeal",method:"post",data:e})}function i(e){return Object(l["a"])({url:"/appeal/getUserAppeals",method:"get",params:{userId:e}})}function s(){return Object(l["a"])({url:"/appeal/getAllAppeals",method:"get"})}function n(e){return Object(l["a"])({url:"/appeal/getAppealsByStatus",method:"get",params:{status:e}})}function o(e,t){return Object(l["a"])({url:"/appeal/approveAppeal",method:"post",params:{appealId:e,adminReply:t}})}function p(e,t){return Object(l["a"])({url:"/appeal/rejectAppeal",method:"post",params:{appealId:e,adminReply:t}})}},"65ed":function(e,t,a){"use strict";a.r(t);var l=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"app-container"},[a("div",{staticClass:"filter-container",staticStyle:{"margin-bottom":"15px"}},[a("el-select",{staticClass:"filter-item",staticStyle:{width:"130px"},attrs:{placeholder:"選擇狀態",clearable:""},on:{change:e.handleStatusChange},model:{value:e.statusFilter,callback:function(t){e.statusFilter=t},expression:"statusFilter"}},e._l(e.statusOptions,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1),a("el-button",{directives:[{name:"waves",rawName:"v-waves"}],staticClass:"filter-item",attrs:{type:"primary",icon:"el-icon-search"},on:{click:e.fetchAppeals}},[e._v(" 查詢 ")]),a("el-button",{directives:[{name:"waves",rawName:"v-waves"}],staticClass:"filter-item",attrs:{type:"primary",icon:"el-icon-refresh"},on:{click:e.handleReset}},[e._v(" 重置 ")])],1),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:e.appeals,border:""}},[a("el-table-column",{attrs:{prop:"appealid",label:"申訴ID",width:"80"}}),a("el-table-column",{attrs:{prop:"username",label:"用戶名稱",width:"120"}}),a("el-table-column",{attrs:{prop:"createTime",label:"提交時間",width:"170"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(e.formatDate(t.row.createTime))+" ")]}}])}),a("el-table-column",{attrs:{prop:"suspensionReason",label:"停權原因","show-overflow-tooltip":""}}),a("el-table-column",{attrs:{prop:"appealContent",label:"申訴內容","show-overflow-tooltip":""}}),a("el-table-column",{attrs:{prop:"status",label:"狀態",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-tag",{attrs:{type:e.getStatusType(t.row.status)}},[e._v(" "+e._s(e.getStatusText(t.row.status))+" ")])]}}])}),a("el-table-column",{attrs:{label:"操作",width:"200"},scopedSlots:e._u([{key:"default",fn:function(t){return[0===t.row.status?a("el-button",{attrs:{size:"mini",type:"success"},on:{click:function(a){return e.handleApprove(t.row)}}},[e._v("批准")]):e._e(),0===t.row.status?a("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(a){return e.handleReject(t.row)}}},[e._v("拒絕")]):e._e(),a("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(a){return e.handleViewDetails(t.row)}}},[e._v("詳情")])]}}])})],1),a("el-dialog",{attrs:{title:"批准申訴",visible:e.approveDialogVisible,width:"30%"},on:{"update:visible":function(t){e.approveDialogVisible=t}}},[a("el-form",{ref:"approveForm",attrs:{model:e.replyForm,rules:e.replyRules,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"管理員回覆",prop:"reply"}},[a("el-input",{attrs:{type:"textarea",rows:4,placeholder:"請輸入批准原因（可選）"},model:{value:e.replyForm.reply,callback:function(t){e.$set(e.replyForm,"reply",t)},expression:"replyForm.reply"}})],1)],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.approveDialogVisible=!1}}},[e._v("取消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.confirmApprove}},[e._v("確定批准")])],1)],1),a("el-dialog",{attrs:{title:"拒絕申訴",visible:e.rejectDialogVisible,width:"30%"},on:{"update:visible":function(t){e.rejectDialogVisible=t}}},[a("el-form",{ref:"rejectForm",attrs:{model:e.replyForm,rules:e.replyRules,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"管理員回覆",prop:"reply"}},[a("el-input",{attrs:{type:"textarea",rows:4,placeholder:"請輸入拒絕原因"},model:{value:e.replyForm.reply,callback:function(t){e.$set(e.replyForm,"reply",t)},expression:"replyForm.reply"}})],1)],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.rejectDialogVisible=!1}}},[e._v("取消")]),a("el-button",{attrs:{type:"danger"},on:{click:e.confirmReject}},[e._v("確定拒絕")])],1)],1),a("el-dialog",{attrs:{title:"申訴詳情",visible:e.detailsDialogVisible,width:"50%"},on:{"update:visible":function(t){e.detailsDialogVisible=t}}},[a("div",{staticClass:"appeal-details"},[a("div",{staticClass:"detail-item"},[a("h4",[e._v("申訴ID")]),a("p",[e._v(e._s(e.currentAppeal.appealid))])]),a("div",{staticClass:"detail-item"},[a("h4",[e._v("用戶名稱")]),a("p",[e._v(e._s(e.currentAppeal.username))])]),a("div",{staticClass:"detail-item"},[a("h4",[e._v("申訴時間")]),a("p",[e._v(e._s(e.formatDate(e.currentAppeal.createTime)))])]),a("div",{staticClass:"detail-item"},[a("h4",[e._v("停權原因")]),a("p",[e._v(e._s(e.currentAppeal.suspensionReason||"無"))])]),a("div",{staticClass:"detail-item"},[a("h4",[e._v("申訴內容")]),a("p",[e._v(e._s(e.currentAppeal.appealContent))])]),a("div",{staticClass:"detail-item"},[a("h4",[e._v("申訴狀態")]),a("p",[a("el-tag",{attrs:{type:e.getStatusType(e.currentAppeal.status)}},[e._v(" "+e._s(e.getStatusText(e.currentAppeal.status))+" ")])],1)]),0!==e.currentAppeal.status?[a("div",{staticClass:"detail-item"},[a("h4",[e._v("處理結果")]),a("p",[e._v(e._s(1===e.currentAppeal.status?"批准":"拒絕"))])]),a("div",{staticClass:"detail-item"},[a("h4",[e._v("管理員回覆")]),a("p",[e._v(e._s(e.currentAppeal.adminReply||"無"))])]),a("div",{staticClass:"detail-item"},[a("h4",[e._v("回覆時間")]),a("p",[e._v(e._s(e.currentAppeal.replyTime?e.formatDate(e.currentAppeal.replyTime):"-"))])])]:e._e()],2),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.detailsDialogVisible=!1}}},[e._v("關閉")])],1)])],1)},r=[],i=(a("99af"),a("e9c4"),a("b64b"),a("4d90"),a("6724")),s=a("58d9"),n={name:"AppealManagement",directives:{waves:i["a"]},data:function(){return{loading:!1,appeals:[],statusFilter:null,statusOptions:[{value:0,label:"待處理"},{value:1,label:"已批准"},{value:2,label:"已拒絕"}],approveDialogVisible:!1,rejectDialogVisible:!1,detailsDialogVisible:!1,currentAppeal:{},replyForm:{appealId:null,reply:""},replyRules:{reply:[{max:200,message:"回覆不能超過200個字符",trigger:"blur"}]}}},created:function(){this.fetchAppeals()},methods:{fetchAppeals:function(){var e=this;this.loading=!0;var t=null!==this.statusFilter?Object(s["d"])(this.statusFilter):Object(s["c"])();t.then((function(t){e.loading=!1,0===t.code?e.appeals=t.data:e.$message.error("獲取申訴記錄失敗")})).catch((function(){e.loading=!1,e.$message.error("獲取申訴記錄失敗")}))},handleStatusChange:function(){this.fetchAppeals()},handleReset:function(){this.statusFilter=null,this.fetchAppeals()},handleApprove:function(e){this.currentAppeal=e,this.replyForm.appealId=e.appealid,this.replyForm.reply="",this.approveDialogVisible=!0},handleReject:function(e){this.currentAppeal=e,this.replyForm.appealId=e.appealid,this.replyForm.reply="",this.rejectDialogVisible=!0},handleViewDetails:function(e){this.currentAppeal=JSON.parse(JSON.stringify(e)),this.detailsDialogVisible=!0},confirmApprove:function(){var e=this;this.$refs.approveForm.validate((function(t){t&&(e.loading=!0,console.log(e.replyForm),Object(s["a"])(e.replyForm.appealId,e.replyForm.reply).then((function(t){e.loading=!1,0===t.status?(e.$message.success("申訴已批准"),e.approveDialogVisible=!1,e.fetchAppeals()):e.$message.error(t.message||"操作失敗")})).catch((function(){e.loading=!1,e.$message.error("操作失敗")})))}))},confirmReject:function(){var e=this;this.$refs.rejectForm.validate((function(t){t&&(e.loading=!0,Object(s["f"])(e.replyForm.appealId,e.replyForm.reply).then((function(t){e.loading=!1,0===t.status?(e.$message.success("申訴已拒絕"),e.rejectDialogVisible=!1,e.fetchAppeals()):e.$message.error(t.message||"操作失敗")})).catch((function(){e.loading=!1,e.$message.error("操作失敗")})))}))},formatDate:function(e){if(!e)return"-";var t=new Date(e),a=t.getFullYear(),l=String(t.getMonth()+1).padStart(2,"0"),r=String(t.getDate()).padStart(2,"0"),i=String(t.getHours()).padStart(2,"0"),s=String(t.getMinutes()).padStart(2,"0");return"".concat(a,"-").concat(l,"-").concat(r," ").concat(i,":").concat(s)},getStatusType:function(e){var t={0:"info",1:"success",2:"danger"};return t[e]||"info"},getStatusText:function(e){var t={0:"待處理",1:"已批准",2:"已拒絕"};return t[e]||"未知"}}},o=n,p=(a("27b5"),a("2877")),c=Object(p["a"])(o,l,r,!1,null,"e9be43a6",null);t["default"]=c.exports},6724:function(e,t,a){"use strict";a("8d41");var l="@@wavesContext";function r(e,t){function a(a){var l=Object.assign({},t.value),r=Object.assign({ele:e,type:"hit",color:"rgba(0, 0, 0, 0.15)"},l),i=r.ele;if(i){i.style.position="relative",i.style.overflow="hidden";var s=i.getBoundingClientRect(),n=i.querySelector(".waves-ripple");switch(n?n.className="waves-ripple":(n=document.createElement("span"),n.className="waves-ripple",n.style.height=n.style.width=Math.max(s.width,s.height)+"px",i.appendChild(n)),r.type){case"center":n.style.top=s.height/2-n.offsetHeight/2+"px",n.style.left=s.width/2-n.offsetWidth/2+"px";break;default:n.style.top=(a.pageY-s.top-n.offsetHeight/2-document.documentElement.scrollTop||document.body.scrollTop)+"px",n.style.left=(a.pageX-s.left-n.offsetWidth/2-document.documentElement.scrollLeft||document.body.scrollLeft)+"px"}return n.style.backgroundColor=r.color,n.className="waves-ripple z-active",!1}}return e[l]?e[l].removeHandle=a:e[l]={removeHandle:a},a}var i={bind:function(e,t){e.addEventListener("click",r(e,t),!1)},update:function(e,t){e.removeEventListener("click",e[l].removeHandle,!1),e.addEventListener("click",r(e,t),!1)},unbind:function(e){e.removeEventListener("click",e[l].removeHandle,!1),e[l]=null,delete e[l]}},s=function(e){e.directive("waves",i)};window.Vue&&(window.waves=i,Vue.use(s)),i.install=s;t["a"]=i},"8d41":function(e,t,a){},"9a0c":function(e,t,a){var l=a("342f");e.exports=/Version\/10\.\d+(\.\d+)?( Mobile\/\w+)? Safari\//.test(l)},d231:function(e,t,a){},e9c4:function(e,t,a){var l=a("23e7"),r=a("d066"),i=a("d039"),s=r("JSON","stringify"),n=/[\uD800-\uDFFF]/g,o=/^[\uD800-\uDBFF]$/,p=/^[\uDC00-\uDFFF]$/,c=function(e,t,a){var l=a.charAt(t-1),r=a.charAt(t+1);return o.test(e)&&!p.test(r)||p.test(e)&&!o.test(l)?"\\u"+e.charCodeAt(0).toString(16):e},u=i((function(){return'"\\udf06\\ud834"'!==s("\udf06\ud834")||'"\\udead"'!==s("\udead")}));s&&l({target:"JSON",stat:!0,forced:u},{stringify:function(e,t,a){var l=s.apply(null,arguments);return"string"==typeof l?l.replace(n,c):l}})}}]);